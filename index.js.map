{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const requestFetch = async (inputValueRequest, page, perPage) => {\n  const params = new URLSearchParams({\n    per_page: perPage,\n    page,\n    safesearch: 'true',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    key: '45720835-cd950b20c56733b9244c71a24',\n    q: inputValueRequest,\n  });\n  const response = await axios.get(`https://pixabay.com/api/?${params}`);\n\n  return response.data;\n};\n","export const createGallery = imgInfo => {\n  return `<li class=\"gallery-item\">\n  <a class=\"img-link\" href=\"${imgInfo.largeImageURL}\">\n  <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" width=\"360\" height=\"200\"/>\n  </a>\n  <div class=\"inf-box\">\n  <b class=\"img-prop\">Likes: <span class=\"img-prop-value\">${imgInfo.likes}</span></b>\n  <b class=\"img-prop\">Views: <span class=\"img-prop-value\">${imgInfo.views}</span></b>\n  <b class=\"img-prop\">Comments: <span class=\"img-prop-value\">${imgInfo.comments}</span></b>\n  <b class=\"img-prop\">Downloads: <span class=\"img-prop-value\">${imgInfo.downloads}</span></b>\n  </div>\n  </li>`;\n};\n\nexport const addElToHTML = (gallery, galleryList) => {\n  galleryList.innerHTML = gallery;\n};\nexport const cleanElHTML = galleryList => {\n  galleryList.innerHTML = '';\n};\n","import iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst lightbox = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nimport { requestFetch } from './js/pixabay-api';\nimport { createGallery, addElToHTML, cleanElHTML } from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst galleryList = document.querySelector('.gallery');\nconst loaderSpan = document.querySelector('#load-more-loader-top');\nconst btn = document.querySelector('.gallery + button');\n\nconst loaderMoreSpan = document.querySelector('#load-more-loader');\n\nlet page = 1;\nlet perPage = 15;\nlet inputValue = '';\nlet firstSubmit = true;\n\nform.addEventListener('submit', async event => {\n  if (!firstSubmit) {\n    btn.classList.remove('js-button');\n  }\n  event.preventDefault();\n\n  inputValue = form.elements.user_query.value.trim();\n\n  page = 1;\n\n  cleanElHTML(galleryList);\n  loaderSpan.classList.add('loader');\n\n  try {\n    const inf = await requestFetch(inputValue, page, perPage);\n\n    if (inf.totalHits === 0) {\n      loaderSpan.classList.remove('loader');\n\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    if (inf.totalHits <= perPage) {\n      console.log(inf.totalHits);\n      console.log(perPage);\n\n      btn.classList.remove('js-button');\n    }\n    const gallery = inf.hits\n      .map(imgInform => createGallery(imgInform))\n      .join('');\n\n    addElToHTML(gallery, galleryList);\n\n    lightbox.refresh();\n\n    loaderSpan.classList.remove('loader');\n    btn.classList.add('js-button');\n  } catch (error) {\n    loaderSpan.classList.remove('loader');\n\n    iziToast.error({\n      message: `Oops! Something went wrong. ${error}`,\n    });\n  }\n\n  loaderMoreSpan.classList.remove('loader');\n\n  firstSubmit = false;\n});\n\nbtn.addEventListener('click', async () => {\n  btn.classList.remove('js-button');\n  if (inputValue === '') {\n    iziToast.error({\n      message: 'Please enter a subject for the photo',\n    });\n    return;\n  }\n\n  loaderMoreSpan.classList.add('loader');\n  inputValue = form.elements.user_query.value.trim();\n\n  try {\n    page += 1;\n    const inf = await requestFetch(inputValue, page, perPage);\n\n    const gallery = inf.hits\n      .map(imgInform => createGallery(imgInform))\n      .join('');\n\n    const galleryListItem = document.querySelector('.gallery-item');\n    const heightOfGalleryItem = galleryListItem.getBoundingClientRect().height;\n\n    const totalPages = Math.ceil(inf.totalHits / perPage);\n    if (page > totalPages) {\n      loaderMoreSpan.classList.remove('loader');\n      btn.classList.remove('js-button');\n\n      return iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n    galleryList.insertAdjacentHTML('beforeend', gallery);\n\n    loaderMoreSpan.classList.remove('loader');\n    btn.classList.add('js-button');\n\n    lightbox.refresh();\n    scrollBy({\n      top: heightOfGalleryItem * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    iziToast.error({\n      message: `Oops! Something went wrong. Erorr: ${error}`,\n    });\n  }\n});\n"],"names":["requestFetch","inputValueRequest","page","perPage","params","axios","createGallery","imgInfo","addElToHTML","gallery","galleryList","cleanElHTML","lightbox","SimpleLightbox","form","loaderSpan","btn","loaderMoreSpan","inputValue","firstSubmit","event","inf","iziToast","imgInform","error","heightOfGalleryItem","totalPages"],"mappings":"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"}